                   
Archlinux budowa kernela metodą klasyczną:
Wymagane pakiety:
sudo pacman -S base-devel bc
opcjonalnie:
usermod -G wheel USERNAME
UWAGA !!! czynności od 1 do 7 wykonujemy na zwykłym userze
1.Generowanie domyślnego configa:
zcat /proc/config.gz > config-arch-default
2. Dodanie kluczy GPG
gpg --locate-keys torvalds@kernel.org gregkh@kernel.org
3. Weryfikacja źródła kernela
Ściągnij źródło i podpis :
wget https://cdn.kernel.org/pub/linux/kernel/v5.x/linux-5.4.6.tar.xz
wget https://cdn.kernel.org/pub/linux/kernel/v5.x/linux-5.4.6.tar.sign
Zweryfikuj podpis:
unxz -c linux-5.4.6.tar.xz | gpg --verify linux-5.4.6.tar.sign -
4. Rozpakowywanie
tar xavf linux-5.4.6.tar.xz
5. Kopiowanie konfiguracji
cp config-arch-default linux-5.4.6/.config
Opcjonalnie możesz użyć :
make localmodconfig
6. Ustawienia własne
make menuconfig

7. Kompilacja
make -j16
8. Instalacja modułów
sudo make modules_install
9. Kopiowanie nowego kernela do folderu /boot
sudo cp -v arch/x86_64/boot/bzImage /boot/vmlinuz-linux-5.4.6
10. Make initial RAM disk
sudo cp /etc/mkinitcpio.d/linux.preset /etc/mkinitcpio.d/linux-5.4.6.preset
11. Edycja pliku linux-5.4.6.preset
sudo vim /etc/mkinitcpio.d/linux-5.4.6.preset
# mkinitcpio preset file for the 'linux' package
ALL_config="/etc/mkinitcpio.conf"
ALL_kver="/boot/vmlinuz-linux-5.4.6"
PRESETS=('default' 'fallback')
#default_config="/etc/mkinitcpio.conf"
default_image="/boot/initramfs-linux-5.4.6.img"
#default_options=""
#fallback_config="/etc/mkinitcpio.conf"
fallback_image="/boot/initramfs-linux-5.4.6-fallback.img"
fallback_options="-S autodetect"

sudo mkinitcpio -p linux-5.4.6

12. Odświeżenie konfiguracji GRUBA
sudo grub-mkconfig -o /boot/grub/grub.cfg



